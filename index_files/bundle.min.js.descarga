/*! For license information please see bundle.min.js.LICENSE.txt */
(()=>{var e={"./node_modules/navigator.sendbeacon/dist/navigator.sendbeacon.es.js":()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t=function(e){return"string"==typeof e},r=function(e){return e instanceof Blob};function n(e,n){var s=this.event&&this.event.type,i="unload"===s||"beforeunload"===s,o="XMLHttpRequest"in this?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");o.open("POST",e,!i),o.withCredentials=!0,o.setRequestHeader("Accept","*/*"),t(n)?(o.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),o.responseType="text"):r(n)&&n.type&&o.setRequestHeader("Content-Type",n.type);try{o.send(n)}catch(e){return!1}return!0}(function(){"navigator"in this||(this.navigator={});"function"!=typeof this.navigator.sendBeacon&&(this.navigator.sendBeacon=n.bind(this))}).call("object"===("undefined"==typeof window?"undefined":e(window))?window:{})},"./node_modules/sourcebuster/dist/sourcebuster.js":e=>{e.exports=function e(t,r,n){function s(o,a){if(!r[o]){if(!t[o]){if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[o]={exports:{}};t[o][0].call(u.exports,(function(e){var r=t[o][1][e];return s(r||e)}),u,u.exports,e,t,r,n)}return r[o].exports}for(var i=void 0,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(e,t,r){"use strict";var n=e("./init"),s={init:function(e){this.get=n(e),e&&e.callback&&"function"==typeof e.callback&&e.callback(this.get)}};t.exports=s},{"./init":6}],2:[function(e,t,r){"use strict";var n=e("./terms"),s=e("./helpers/utils"),i={containers:{current:"sbjs_current",current_extra:"sbjs_current_add",first:"sbjs_first",first_extra:"sbjs_first_add",session:"sbjs_session",udata:"sbjs_udata",promocode:"sbjs_promo"},service:{migrations:"sbjs_migrations"},delimiter:"|||",aliases:{main:{type:"typ",source:"src",medium:"mdm",campaign:"cmp",content:"cnt",term:"trm"},extra:{fire_date:"fd",entrance_point:"ep",referer:"rf"},session:{pages_seen:"pgs",current_page:"cpg"},udata:{visits:"vst",ip:"uip",agent:"uag"},promo:"code"},pack:{main:function(e){return i.aliases.main.type+"="+e.type+i.delimiter+i.aliases.main.source+"="+e.source+i.delimiter+i.aliases.main.medium+"="+e.medium+i.delimiter+i.aliases.main.campaign+"="+e.campaign+i.delimiter+i.aliases.main.content+"="+e.content+i.delimiter+i.aliases.main.term+"="+e.term},extra:function(e){return i.aliases.extra.fire_date+"="+s.setDate(new Date,e)+i.delimiter+i.aliases.extra.entrance_point+"="+document.location.href+i.delimiter+i.aliases.extra.referer+"="+(document.referrer||n.none)},user:function(e,t){return i.aliases.udata.visits+"="+e+i.delimiter+i.aliases.udata.ip+"="+t+i.delimiter+i.aliases.udata.agent+"="+navigator.userAgent},session:function(e){return i.aliases.session.pages_seen+"="+e+i.delimiter+i.aliases.session.current_page+"="+document.location.href},promo:function(e){return i.aliases.promo+"="+s.setLeadingZeroToInt(s.randomInt(e.min,e.max),e.max.toString().length)}}};t.exports=i},{"./helpers/utils":5,"./terms":9}],3:[function(e,t,r){"use strict";var n=e("../data").delimiter;t.exports={encodeData:function(e){return encodeURIComponent(e).replace(/\!/g,"%21").replace(/\~/g,"%7E").replace(/\*/g,"%2A").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")},decodeData:function(e){try{return decodeURIComponent(e).replace(/\%21/g,"!").replace(/\%7E/g,"~").replace(/\%2A/g,"*").replace(/\%27/g,"'").replace(/\%28/g,"(").replace(/\%29/g,")")}catch(t){try{return unescape(e)}catch(e){return""}}},set:function(e,t,r,n,s){var i,o;if(r){var a=new Date;a.setTime(a.getTime()+60*r*1e3),i="; expires="+a.toGMTString()}else i="";o=n&&!s?";domain=."+n:"",document.cookie=this.encodeData(e)+"="+this.encodeData(t)+i+o+"; path=/"},get:function(e){for(var t=this.encodeData(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var s=r[n];" "===s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(t))return this.decodeData(s.substring(t.length,s.length))}return null},destroy:function(e,t,r){this.set(e,"",-1,t,r)},parse:function(e){var t=[],r={};if("string"==typeof e)t.push(e);else for(var s in e)e.hasOwnProperty(s)&&t.push(e[s]);for(var i=0;i<t.length;i++){var o;r[this.unsbjs(t[i])]={},o=this.get(t[i])?this.get(t[i]).split(n):[];for(var a=0;a<o.length;a++){var c=o[a].split("="),u=c.splice(0,1);u.push(c.join("=")),r[this.unsbjs(t[i])][u[0]]=this.decodeData(u[1])}}return r},unsbjs:function(e){return e.replace("sbjs_","")}}},{"../data":2}],4:[function(e,t,r){"use strict";t.exports={parse:function(e){for(var t=this.parseOptions,r=t.parser[t.strictMode?"strict":"loose"].exec(e),n={},s=14;s--;)n[t.key[s]]=r[s]||"";return n[t.q.name]={},n[t.key[12]].replace(t.q.parser,(function(e,r,s){r&&(n[t.q.name][r]=s)})),n},parseOptions:{strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},getParam:function(e){for(var t={},r=(e||window.location.search.substring(1)).split("&"),n=0;n<r.length;n++){var s=r[n].split("=");if(void 0===t[s[0]])t[s[0]]=s[1];else if("string"==typeof t[s[0]]){var i=[t[s[0]],s[1]];t[s[0]]=i}else t[s[0]].push(s[1])}return t},getHost:function(e){return this.parse(e).host.replace("www.","")}}},{}],5:[function(e,t,r){"use strict";t.exports={escapeRegexp:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},setDate:function(e,t){var r=e.getTimezoneOffset()/60,n=e.getHours(),s=t||0===t?t:-r;return e.setHours(n+r+s),e.getFullYear()+"-"+this.setLeadingZeroToInt(e.getMonth()+1,2)+"-"+this.setLeadingZeroToInt(e.getDate(),2)+" "+this.setLeadingZeroToInt(e.getHours(),2)+":"+this.setLeadingZeroToInt(e.getMinutes(),2)+":"+this.setLeadingZeroToInt(e.getSeconds(),2)},setLeadingZeroToInt:function(e,t){for(var r=e+"";r.length<t;)r="0"+r;return r},randomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}}},{}],6:[function(e,t,r){"use strict";var n=e("./data"),s=e("./terms"),i=e("./helpers/cookies"),o=e("./helpers/uri"),a=e("./helpers/utils"),c=e("./params"),u=e("./migrations");t.exports=function(e){var t,r,p,l,d,f,m,g,h,y=c.fetch(e),v=o.getParam(),_=y.domain.host,b=y.domain.isolate,x=y.lifetime;function w(){var e;if(void 0!==v.utm_source||void 0!==v.utm_medium||void 0!==v.utm_campaign||void 0!==v.utm_content||void 0!==v.utm_term||void 0!==v.gclid||void 0!==v.yclid||void 0!==v[y.campaign_param])I(),e=k(s.traffic.utm);else if(S(s.traffic.organic))I(),e=k(s.traffic.organic);else if(!i.get(n.containers.session)&&S(s.traffic.referral))I(),e=k(s.traffic.referral);else{if(i.get(n.containers.first)||i.get(n.containers.current))return i.get(n.containers.current);I(),e=k(s.traffic.typein)}return e}function k(e){switch(e){case s.traffic.utm:t=s.traffic.utm,r=void 0!==v.utm_source?v.utm_source:void 0!==v.gclid?"google":void 0!==v.yclid?"yandex":s.none,p=void 0!==v.utm_medium?v.utm_medium:void 0!==v.gclid||void 0!==v.yclid?"cpc":s.none,l=void 0!==v.utm_campaign?v.utm_campaign:void 0!==v[y.campaign_param]?v[y.campaign_param]:void 0!==v.gclid?"google_cpc":void 0!==v.yclid?"yandex_cpc":s.none,d=v.utm_content||s.none,f=j()||s.none;break;case s.traffic.organic:t=s.traffic.organic,r=r||o.getHost(document.referrer),p=s.referer.organic,l=s.none,d=s.none,f=s.none;break;case s.traffic.referral:t=s.traffic.referral,r=r||o.getHost(document.referrer),p=p||s.referer.referral,l=s.none,d=o.parse(document.referrer).path,f=s.none;break;case s.traffic.typein:t=s.traffic.typein,r=y.typein_attributes.source,p=y.typein_attributes.medium,l=s.none,d=s.none,f=s.none;break;default:t=s.oops,r=s.oops,p=s.oops,l=s.oops,d=s.oops,f=s.oops}var i={type:t,source:r,medium:p,campaign:l,content:d,term:f};return n.pack.main(i)}function j(){var e=document.referrer;if(v.utm_term)return v.utm_term;if(!(e&&o.parse(e).host&&o.parse(e).host.match(/^(?:.*\.)?yandex\..{2,9}$/i)))return!1;try{return o.getParam(o.parse(document.referrer).query).text}catch(e){return!1}}function S(e){var t=document.referrer;switch(e){case s.traffic.organic:return!!t&&O(t)&&R(t);case s.traffic.referral:return!!t&&O(t)&&q(t);default:return!1}}function O(e){if(y.domain){if(b)return o.getHost(e)!==o.getHost(_);var t=new RegExp("^(?:.*\\.)?"+a.escapeRegexp(_)+"$","i");return!o.getHost(e).match(t)}return o.getHost(e)!==o.getHost(document.location.href)}function R(e){var t="yandex",n="text",s="google",i=new RegExp("^(?:.*\\.)?"+a.escapeRegexp(t)+"\\..{2,9}$"),c=new RegExp(".*"+a.escapeRegexp(n)+"=.*"),u=new RegExp("^(?:www\\.)?"+a.escapeRegexp(s)+"\\..{2,9}$");if(o.parse(e).query&&o.parse(e).host.match(i)&&o.parse(e).query.match(c))return r=t,!0;if(o.parse(e).host.match(u))return r=s,!0;if(!o.parse(e).query)return!1;for(var p=0;p<y.organics.length;p++){if(o.parse(e).host.match(new RegExp("^(?:.*\\.)?"+a.escapeRegexp(y.organics[p].host)+"$","i"))&&o.parse(e).query.match(new RegExp(".*"+a.escapeRegexp(y.organics[p].param)+"=.*","i")))return r=y.organics[p].display||y.organics[p].host,!0;if(p+1===y.organics.length)return!1}}function q(e){if(!(y.referrals.length>0))return r=o.getHost(e),!0;for(var t=0;t<y.referrals.length;t++){if(o.parse(e).host.match(new RegExp("^(?:.*\\.)?"+a.escapeRegexp(y.referrals[t].host)+"$","i")))return r=y.referrals[t].display||y.referrals[t].host,p=y.referrals[t].medium||s.referer.referral,!0;if(t+1===y.referrals.length)return r=o.getHost(e),!0}}function I(){i.set(n.containers.current_extra,n.pack.extra(y.timezone_offset),x,_,b),i.get(n.containers.first_extra)||i.set(n.containers.first_extra,n.pack.extra(y.timezone_offset),x,_,b)}return u.go(x,_,b),i.set(n.containers.current,w(),x,_,b),i.get(n.containers.first)||i.set(n.containers.first,i.get(n.containers.current),x,_,b),i.get(n.containers.udata)?(m=parseInt(i.parse(n.containers.udata)[i.unsbjs(n.containers.udata)][n.aliases.udata.visits])||1,m=i.get(n.containers.session)?m:m+1,g=n.pack.user(m,y.user_ip)):(m=1,g=n.pack.user(m,y.user_ip)),i.set(n.containers.udata,g,x,_,b),i.get(n.containers.session)?(h=parseInt(i.parse(n.containers.session)[i.unsbjs(n.containers.session)][n.aliases.session.pages_seen])||1,h+=1):h=1,i.set(n.containers.session,n.pack.session(h),y.session_length,_,b),y.promocode&&!i.get(n.containers.promocode)&&i.set(n.containers.promocode,n.pack.promo(y.promocode),x,_,b),i.parse(n.containers)}},{"./data":2,"./helpers/cookies":3,"./helpers/uri":4,"./helpers/utils":5,"./migrations":7,"./params":8,"./terms":9}],7:[function(e,t,r){"use strict";var n=e("./data"),s=e("./helpers/cookies");t.exports={go:function(e,t,r){var i,o=this.migrations,a={l:e,d:t,i:r};if(s.get(n.containers.first)||s.get(n.service.migrations)){if(!s.get(n.service.migrations))for(i=0;i<o.length;i++)o[i].go(o[i].id,a)}else{var c=[];for(i=0;i<o.length;i++)c.push(o[i].id);var u="";for(i=0;i<c.length;i++)u+=c[i]+"=1",i<c.length-1&&(u+=n.delimiter);s.set(n.service.migrations,u,a.l,a.d,a.i)}},migrations:[{id:"1418474375998",version:"1.0.0-beta",go:function(e,t){var r=e+"=1",i=e+"=0",o=function(e,t,r){return t||r?e:n.delimiter};try{var a=[];for(var c in n.containers)n.containers.hasOwnProperty(c)&&a.push(n.containers[c]);for(var u=0;u<a.length;u++)if(s.get(a[u])){var p=s.get(a[u]).replace(/(\|)?\|(\|)?/g,o);s.destroy(a[u],t.d,t.i),s.destroy(a[u],t.d,!t.i),s.set(a[u],p,t.l,t.d,t.i)}s.get(n.containers.session)&&s.set(n.containers.session,n.pack.session(0),t.l,t.d,t.i),s.set(n.service.migrations,r,t.l,t.d,t.i)}catch(e){s.set(n.service.migrations,i,t.l,t.d,t.i)}}}]}},{"./data":2,"./helpers/cookies":3}],8:[function(e,t,r){"use strict";var n=e("./terms"),s=e("./helpers/uri");t.exports={fetch:function(e){var t=e||{},r={};if(r.lifetime=this.validate.checkFloat(t.lifetime)||6,r.lifetime=parseInt(30*r.lifetime*24*60),r.session_length=this.validate.checkInt(t.session_length)||30,r.timezone_offset=this.validate.checkInt(t.timezone_offset),r.campaign_param=t.campaign_param||!1,r.user_ip=t.user_ip||n.none,t.promocode?(r.promocode={},r.promocode.min=parseInt(t.promocode.min)||1e5,r.promocode.max=parseInt(t.promocode.max)||999999):r.promocode=!1,t.typein_attributes&&t.typein_attributes.source&&t.typein_attributes.medium?(r.typein_attributes={},r.typein_attributes.source=t.typein_attributes.source,r.typein_attributes.medium=t.typein_attributes.medium):r.typein_attributes={source:"(direct)",medium:"(none)"},t.domain&&this.validate.isString(t.domain)?r.domain={host:t.domain,isolate:!1}:t.domain&&t.domain.host?r.domain=t.domain:r.domain={host:s.getHost(document.location.hostname),isolate:!1},r.referrals=[],t.referrals&&t.referrals.length>0)for(var i=0;i<t.referrals.length;i++)t.referrals[i].host&&r.referrals.push(t.referrals[i]);if(r.organics=[],t.organics&&t.organics.length>0)for(var o=0;o<t.organics.length;o++)t.organics[o].host&&t.organics[o].param&&r.organics.push(t.organics[o]);return r.organics.push({host:"bing.com",param:"q",display:"bing"}),r.organics.push({host:"yahoo.com",param:"p",display:"yahoo"}),r.organics.push({host:"about.com",param:"q",display:"about"}),r.organics.push({host:"aol.com",param:"q",display:"aol"}),r.organics.push({host:"ask.com",param:"q",display:"ask"}),r.organics.push({host:"globososo.com",param:"q",display:"globo"}),r.organics.push({host:"go.mail.ru",param:"q",display:"go.mail.ru"}),r.organics.push({host:"rambler.ru",param:"query",display:"rambler"}),r.organics.push({host:"tut.by",param:"query",display:"tut.by"}),r.referrals.push({host:"t.co",display:"twitter.com"}),r.referrals.push({host:"plus.url.google.com",display:"plus.google.com"}),r},validate:{checkFloat:function(e){return!(!e||!this.isNumeric(parseFloat(e)))&&parseFloat(e)},checkInt:function(e){return!(!e||!this.isNumeric(parseInt(e)))&&parseInt(e)},isNumeric:function(e){return!isNaN(e)},isString:function(e){return"[object String]"===Object.prototype.toString.call(e)}}}},{"./helpers/uri":4,"./terms":9}],9:[function(e,t,r){"use strict";t.exports={traffic:{utm:"utm",organic:"organic",referral:"referral",typein:"typein"},referer:{referral:"referral",organic:"organic",social:"social"},none:"(none)",oops:"(Houston, we have a problem)"}},{}]},{},[1])(1)}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n);var e,t=r("./node_modules/sourcebuster/dist/sourcebuster.js");r("./node_modules/navigator.sendbeacon/dist/navigator.sendbeacon.es.js");t.init(),window.rrpCapture=e=>{if(!rrp_settings||"object"!=typeof rrp_settings)throw new Error("rrp_settings must be defined");if(!("url"in rrp_settings))throw new Error("rrp_settings.url must be defined");if(!("key"in rrp_settings))throw new Error("rrp_settings.key must be defined");let t={cookies:document.cookie.split(";").reduce(((e,t)=>Object.assign(e,{[t.split("=")[0].trim()]:decodeURIComponent(t.split("=")[1])})),{}),values:e},r=new URL(`${rrp_settings.url}/api/${rrp_settings.key}/capture`.replace("//","/"));return navigator.sendBeacon(r.toString(),JSON.stringify(t)),!0},(e="[data-chat-id]",new Promise((function(t,r){let n=document.querySelector(e);if(n)return void t(n);let s=new MutationObserver((function(r){r.forEach((function(r){if("attributes"===r.type){let r=document.querySelector(e);if(r)return s.disconnect(),void t(r)}[].forEach.call(r.addedNodes,(function(r){if(r.matches&&r.matches(e))return s.disconnect(),void t(r)}))}))}));s.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0})}))).then((function(e){const t=document.cookie.split(";").reduce(((e,t)=>Object.assign(e,{[t.split("=")[0].trim()]:decodeURIComponent(t.split("=")[1])})),{}),r=Object.keys(t).filter((e=>e.match(/^sbjs/i))).reduce(((e,r)=>({...e,[r]:t[r]})),{});Promise.all(rrp_settings.chat_api_urls.map((t=>async function(e,t){try{let r=await fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(t)});return await r.json()}catch(e){console.error("Error:",e)}}(t.toString(),{chat_id:e.getAttribute("data-chat-id"),json:JSON.stringify({cookies:r})})))).then((e=>Promise.all(e.map((e=>e)))))})),document.addEventListener("DOMContentLoaded",(function(){let e=new URLSearchParams(window.location.search),t=new URL(rrp_settings.fetch_campaigns_url.toString());e.has("rrpclear")&&t.searchParams.append("rrpclear","1"),fetch(t.toString(),{method:"POST"}).then((e=>e.json())).catch((e=>{console.log("Error: ",e)}))}))})()})();
//# sourceMappingURL=bundle.js.map